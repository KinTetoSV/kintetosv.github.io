<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ping Pong Online Multiplayer</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a2a3a, #0a0e17);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
        }

        .container {
            text-align: center;
            max-width: 1000px;
            width: 100%;
            padding: 20px;
        }

        header {
            margin-bottom: 20px;
        }

        h1 {
            font-size: 3rem;
            color: #FFD700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #ccc;
            margin-bottom: 30px;
        }

        /* Screens */
        .screen {
            display: none;
            width: 100%;
        }

        .active {
            display: block;
        }

        /* Lobby Screen */
        .lobby-screen {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .connection-status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
        }

        .status-connected {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
        }

        .status-waiting {
            background: rgba(255, 193, 7, 0.2);
            color: #FFC107;
        }

        .status-disconnected {
            background: rgba(244, 67, 54, 0.2);
            color: #F44336;
        }

        .player-list {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            flex-wrap: wrap;
            gap: 20px;
        }

        .player-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            min-width: 200px;
            transition: all 0.3s ease;
        }

        .player-card.ready {
            border: 2px solid #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }

        .player-card.waiting {
            border: 2px solid #FFC107;
        }

        /* Game Screen */
        .game-container {
            position: relative;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            margin-bottom: 20px;
        }

        #gameCanvas {
            background: #0a1429;
            border: 2px solid #FFD700;
            border-radius: 5px;
            display: block;
            margin: 0 auto;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
            max-width: 100%;
        }

        .score-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .player-score {
            background: rgba(255, 215, 0, 0.2);
            padding: 10px 20px;
            border-radius: 8px;
            min-width: 120px;
        }

        .player1 {
            color: #4FC3F7;
        }

        .player2 {
            color: #FF5252;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .player-controls {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            flex: 1;
            min-width: 200px;
        }

        .player-controls h3 {
            color: #FFD700;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .key {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 5px;
            margin: 0 5px;
            font-weight: bold;
        }

        .mobile-controls {
            display: none;
            margin-top: 20px;
            gap: 10px;
            justify-content: center;
        }

        .mobile-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 1.2rem;
            cursor: pointer;
            min-width: 80px;
            touch-action: manipulation;
        }

        .mobile-btn:active {
            background: rgba(255, 215, 0, 0.3);
        }

        /* Buttons */
        .btn {
            background: linear-gradient(to right, #FFD700, #ecc94b);
            color: #1a202c;
            border: none;
            padding: 12px 25px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
            margin: 10px 5px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn-ready {
            background: linear-gradient(to right, #4CAF50, #45a049);
        }

        .btn-leave {
            background: linear-gradient(to right, #FF5252, #F44336);
        }

        /* Instructions */
        .instructions {
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            text-align: left;
        }

        .instructions h2 {
            color: #FFD700;
            margin-bottom: 15px;
            text-align: center;
        }

        .instructions ul {
            list-style-type: none;
            padding: 0;
        }

        .instructions li {
            margin-bottom: 10px;
            padding-left: 20px;
            position: relative;
        }

        .instructions li:before {
            content: "â€¢";
            color: #FFD700;
            position: absolute;
            left: 0;
        }

        /* QR Code */
        .qr-container {
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 10px;
            display: inline-block;
        }

        #qrCode {
            width: 200px;
            height: 200px;
        }

        .share-link {
            margin: 15px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: inline-block;
        }

        .share-link input {
            background: transparent;
            border: 1px solid #FFD700;
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            width: 300px;
            text-align: center;
        }

        footer {
            margin-top: 30px;
            color: #aaa;
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.2rem;
            }
            
            #gameCanvas {
                width: 100%;
                height: auto;
            }
            
            .player-list {
                flex-direction: column;
                align-items: center;
            }
            
            .mobile-controls {
                display: flex;
            }
            
            .share-link input {
                width: 250px;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .player-score {
                font-size: 1.2rem;
                min-width: 100px;
                padding: 8px 15px;
            }
            
            .lobby-screen {
                padding: 20px;
            }
            
            .share-link input {
                width: 200px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Ping Pong Online</h1>
            <p class="subtitle">JoacÄƒ cu prietenii de pe dispozitive diferite</p>
        </header>

        <!-- Lobby Screen -->
        <div id="lobbyScreen" class="screen active">
            <div class="lobby-screen">
                <h2>Sala de AÈ™teptare</h2>
                
                <div id="connectionStatus" class="connection-status status-waiting">
                    <p>Se conecteazÄƒ la server...</p>
                </div>

                <div class="player-list">
                    <div class="player-card waiting" id="player1Card">
                        <h3>JucÄƒtor 1</h3>
                        <p id="player1Status">ÃŽn aÈ™teptare...</p>
                        <p id="player1Device">-</p>
                    </div>
                    
                    <div class="player-card waiting" id="player2Card">
                        <h3>JucÄƒtor 2</h3>
                        <p id="player2Status">ÃŽn aÈ™teptare...</p>
                        <p id="player2Device">-</p>
                    </div>
                </div>

                <div class="qr-container">
                    <div id="qrCode"></div>
                </div>
                <p>ScaneazÄƒ codul QR pentru a te conecta de pe telefon</p>

                <div class="share-link">
                    <p>Sau copiazÄƒ linkul:</p>
                    <input type="text" id="gameLink" readonly>
                    <button onclick="copyLink()" class="btn" style="margin-top: 10px;">CopiazÄƒ Link</button>
                </div>

                <div>
                    <button id="readyBtn" class="btn btn-ready" disabled>SUNT GATA</button>
                    <button id="leaveBtn" class="btn btn-leave">PÄ‚RÄ‚SEÈ˜TE</button>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="gameScreen" class="screen">
            <div class="score-container">
                <div class="player-score player1">JucÄƒtor 1: <span id="score1">0</span></div>
                <div class="player-score player2">JucÄƒtor 2: <span id="score2">0</span></div>
            </div>

            <div class="game-container">
                <canvas id="gameCanvas" width="800" height="400"></canvas>
                
                <div class="mobile-controls">
                    <button class="mobile-btn" id="upBtn">â†‘</button>
                    <button class="mobile-btn" id="downBtn">â†“</button>
                </div>
                
                <div class="controls">
                    <div class="player-controls">
                        <h3>JucÄƒtor 1</h3>
                        <p>MiÈ™cÄƒ: <span class="key">W</span> È™i <span class="key">S</span></p>
                    </div>
                    
                    <div class="player-controls">
                        <h3>JucÄƒtor 2</h3>
                        <p>MiÈ™cÄƒ: <span class="key">â†‘</span> È™i <span class="key">â†“</span></p>
                    </div>
                </div>
                
                <div>
                    <button id="pauseBtn" class="btn">PAUZÄ‚</button>
                    <button id="backToLobbyBtn" class="btn btn-leave">ÃŽNAPOI LA LOBBY</button>
                </div>
            </div>
        </div>

        <div class="instructions">
            <h2>Cum se joacÄƒ</h2>
            <ul>
                <li><strong>PC:</strong> FoloseÈ™te tastele W/S sau sÄƒgeÈ›ile pentru a miÈ™ca paleta</li>
                <li><strong>Telefon:</strong> ApasÄƒ butoanele SUS/JOS pentru a miÈ™ca paleta</li>
                <li>Primul jucÄƒtor care ajunge la 5 puncte cÃ¢È™tigÄƒ</li>
                <li>Mingea accelereazÄƒ dupÄƒ fiecare loviturÄƒ</li>
                <li>ScaneazÄƒ codul QR sau copiazÄƒ linkul pentru a te conecta cu telefonul</li>
            </ul>
        </div>

        <footer>
            <p>Ping Pong Online Multiplayer | ConecteazÄƒ-te cu prietenii de pe dispozitive diferite</p>
        </footer>
    </div>

    <script>
        // Server simulation using PeerJS and simple WebSocket-like functionality
        class GameServer {
            constructor() {
                this.players = {};
                this.gameState = null;
                this.roomId = this.generateRoomId();
            }

            generateRoomId() {
                return Math.random().toString(36).substring(2, 8).toUpperCase();
            }

            connect(playerId, playerData) {
                this.players[playerId] = {
                    ...playerData,
                    ready: false,
                    score: 0,
                    connected: true,
                    paddleY: 160
                };
                this.broadcastPlayerList();
                return true;
            }

            disconnect(playerId) {
                if (this.players[playerId]) {
                    this.players[playerId].connected = false;
                    this.broadcastPlayerList();
                }
            }

            setReady(playerId) {
                if (this.players[playerId]) {
                    this.players[playerId].ready = true;
                    this.broadcastPlayerList();
                    
                    // Start game if both players are ready
                    const readyPlayers = Object.values(this.players).filter(p => p.ready && p.connected);
                    if (readyPlayers.length === 2) {
                        this.startGame();
                    }
                }
            }

            broadcastPlayerList() {
                const playerList = Object.values(this.players);
                if (typeof window.updatePlayerList === 'function') {
                    window.updatePlayerList(playerList);
                }
            }

            startGame() {
                this.gameState = {
                    ballX: 400,
                    ballY: 200,
                    ballSpeedX: 5,
                    ballSpeedY: 3,
                    scores: [0, 0],
                    lastUpdate: Date.now()
                };
                
                if (typeof window.startGame === 'function') {
                    window.startGame();
                }
            }

            updatePaddlePosition(playerId, y) {
                if (this.players[playerId]) {
                    this.players[playerId].paddleY = Math.max(0, Math.min(320, y));
                }
            }

            updateGame() {
                if (!this.gameState) return;

                const now = Date.now();
                const deltaTime = (now - this.gameState.lastUpdate) / 16;
                this.gameState.lastUpdate = now;

                // Update ball position
                this.gameState.ballX += this.gameState.ballSpeedX * deltaTime;
                this.gameState.ballY += this.gameState.ballSpeedY * deltaTime;

                // Ball collision with top and bottom
                if (this.gameState.ballY <= 0 || this.gameState.ballY >= 400) {
                    this.gameState.ballSpeedY = -this.gameState.ballSpeedY;
                }

                // Ball collision with paddles
                const player1 = this.players['player1'];
                const player2 = this.players['player2'];

                if (player1 && this.gameState.ballX <= 20 && 
                    this.gameState.ballY >= player1.paddleY && 
                    this.gameState.ballY <= player1.paddleY + 80) {
                    this.gameState.ballSpeedX = Math.abs(this.gameState.ballSpeedX) * 1.1;
                    const hitPos = (this.gameState.ballY - player1.paddleY) / 80;
                    this.gameState.ballSpeedY = (hitPos - 0.5) * 8;
                }

                if (player2 && this.gameState.ballX >= 780 && 
                    this.gameState.ballY >= player2.paddleY && 
                    this.gameState.ballY <= player2.paddleY + 80) {
                    this.gameState.ballSpeedX = -Math.abs(this.gameState.ballSpeedX) * 1.1;
                    const hitPos = (this.gameState.ballY - player2.paddleY) / 80;
                    this.gameState.ballSpeedY = (hitPos - 0.5) * 8;
                }

                // Score points
                if (this.gameState.ballX < 0) {
                    this.gameState.scores[1]++;
                    this.resetBall();
                } else if (this.gameState.ballX > 800) {
                    this.gameState.scores[0]++;
                    this.resetBall();
                }

                // Check for winner
                if (this.gameState.scores[0] >= 5 || this.gameState.scores[1] >= 5) {
                    this.endGame();
                }

                // Broadcast updated game state
                if (typeof window.updateGameState === 'function') {
                    window.updateGameState(this.getGameState());
                }
            }

            resetBall() {
                this.gameState.ballX = 400;
                this.gameState.ballY = 200;
                this.gameState.ballSpeedX = (Math.random() > 0.5 ? 1 : -1) * 5;
                this.gameState.ballSpeedY = (Math.random() * 4) - 2;
            }

            endGame() {
                const winner = this.gameState.scores[0] >= 5 ? 'player1' : 'player2';
                if (typeof window.endGame === 'function') {
                    window.endGame(winner);
                }
                this.gameState = null;
                
                // Reset player ready status
                Object.values(this.players).forEach(player => {
                    player.ready = false;
                });
                this.broadcastPlayerList();
            }

            getGameState() {
                const player1 = this.players['player1'];
                const player2 = this.players['player2'];
                
                return {
                    ballX: this.gameState?.ballX || 400,
                    ballY: this.gameState?.ballY || 200,
                    paddle1Y: player1?.paddleY || 160,
                    paddle2Y: player2?.paddleY || 160,
                    scores: this.gameState?.scores || [0, 0]
                };
            }
        }

        // Client-side game logic
        class PingPongGame {
            constructor() {
                this.canvas = document.getElementById('gameCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.server = new GameServer();
                
                // Game state
                this.gameRunning = false;
                this.gamePaused = false;
                this.animationId = null;
                
                // Player info
                this.playerId = null;
                this.playerDevice = this.detectDevice();
                
                // Initialize
                this.init();
            }

            detectDevice() {
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                return isMobile ? 'mobile' : 'desktop';
            }

            init() {
                this.setupEventListeners();
                this.connectToServer();
                this.generateQRCode();
                this.updateGameLink();
                this.drawLobby();
            }

            setupEventListeners() {
                // Lobby buttons
                document.getElementById('readyBtn').addEventListener('click', () => this.setReady());
                document.getElementById('leaveBtn').addEventListener('click', () => this.leaveGame());
                document.getElementById('backToLobbyBtn').addEventListener('click', () => this.backToLobby());
                document.getElementById('pauseBtn').addEventListener('click', () => this.togglePause());

                // Keyboard controls
                document.addEventListener('keydown', (e) => this.handleKeyDown(e));
                document.addEventListener('keyup', (e) => this.handleKeyUp(e));

                // Mobile controls
                const upBtn = document.getElementById('upBtn');
                const downBtn = document.getElementById('downBtn');
                
                upBtn.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    this.mobileMove(-1);
                });
                upBtn.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    this.mobileMove(0);
                });
                
                downBtn.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    this.mobileMove(1);
                });
                downBtn.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    this.mobileMove(0);
                });

                // Expose functions to global scope for server communication
                window.updatePlayerList = (players) => this.updatePlayerList(players);
                window.startGame = () => this.startGame();
                window.updateGameState = (gameState) => this.updateGameState(gameState);
                window.endGame = (winner) => this.endGame(winner);
            }

            connectToServer() {
                // Simulate connection delay
                setTimeout(() => {
                    this.playerId = 'player' + (Object.keys(this.server.players).length + 1);
                    const success = this.server.connect(this.playerId, {
                        name: this.playerId,
                        device: this.playerDevice
                    });

                    if (success) {
                        this.updateConnectionStatus('connected', 'Conectat la server');
                        document.getElementById('readyBtn').disabled = false;
                    }
                }, 1000);
            }

            setReady() {
                if (this.playerId) {
                    this.server.setReady(this.playerId);
                    document.getElementById('readyBtn').disabled = true;
                    document.getElementById('readyBtn').textContent = 'GATA';
                }
            }

            leaveGame() {
                // Reset game state
                this.gameRunning = false;
                this.gamePaused = false;
                if (this.animationId) {
                    cancelAnimationFrame(this.animationId);
                }
                
                // Disconnect from server
                if (this.playerId) {
                    this.server.disconnect(this.playerId);
                }
                
                // Show lobby
                this.showScreen('lobbyScreen');
                
                // Reset UI
                document.getElementById('readyBtn').disabled = false;
                document.getElementById('readyBtn').textContent = 'SUNT GATA';
            }

            backToLobby() {
                this.leaveGame();
            }

            startGame() {
                this.gameRunning = true;
                this.gamePaused = false;
                this.showScreen('gameScreen');
                this.animationId = requestAnimationFrame(() => this.gameLoop());
            }

            togglePause() {
                if (this.gameRunning) {
                    this.gamePaused = !this.gamePaused;
                    document.getElementById('pauseBtn').textContent = this.gamePaused ? 'CONTINUÄ‚' : 'PAUZÄ‚';
                    
                    if (this.gamePaused) {
                        cancelAnimationFrame(this.animationId);
                    } else {
                        this.animationId = requestAnimationFrame(() => this.gameLoop());
                    }
                }
            }

            handleKeyDown(e) {
                if (!this.gameRunning || this.gamePaused) return;

                let moveDirection = 0;
                if ((e.key === 'w' || e.key === 'W') && this.playerId === 'player1') {
                    moveDirection = -1;
                } else if ((e.key === 's' || e.key === 'S') && this.playerId === 'player1') {
                    moveDirection = 1;
                } else if (e.key === 'ArrowUp' && this.playerId === 'player2') {
                    moveDirection = -1;
                } else if (e.key === 'ArrowDown' && this.playerId === 'player2') {
                    moveDirection = 1;
                }

                if (moveDirection !== 0) {
                    this.sendMoveAction(moveDirection);
                }
            }

            handleKeyUp(e) {
                if (!this.gameRunning || this.gamePaused) return;

                if (
                    (e.key === 'w' || e.key === 'W' || e.key === 's' || e.key === 'S') && this.playerId === 'player1' ||
                    (e.key === 'ArrowUp' || e.key === 'ArrowDown') && this.playerId === 'player2'
                ) {
                    this.sendMoveAction(0);
                }
            }

            mobileMove(direction) {
                if (!this.gameRunning || this.gamePaused) return;
                this.sendMoveAction(direction);
            }

            sendMoveAction(direction) {
                if (this.playerId) {
                    const speed = 8;
                    const currentY = this.server.players[this.playerId]?.paddleY || 160;
                    const newY = currentY + (direction * speed);
                    
                    this.server.updatePaddlePosition(this.playerId, newY);
                }
            }

            updateGameState(gameState) {
                // Store the latest game state from server
                this.currentGameState = gameState;
            }

            gameLoop() {
                if (this.gamePaused) return;

                // Update server game state
                this.server.updateGame();
                
                this.draw();
                
                if (this.gameRunning) {
                    this.animationId = requestAnimationFrame(() => this.gameLoop());
                }
            }

            draw() {
                const gameState = this.currentGameState || this.server.getGameState();
                const ctx = this.ctx;
                const canvas = this.canvas;

                // Clear canvas
                ctx.fillStyle = '#0a1429';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Draw center line
                ctx.setLineDash([5, 15]);
                ctx.beginPath();
                ctx.moveTo(canvas.width / 2, 0);
                ctx.lineTo(canvas.width / 2, canvas.height);
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
                ctx.stroke();
                ctx.setLineDash([]);

                // Draw paddles
                ctx.fillStyle = '#4FC3F7';
                ctx.fillRect(0, gameState.paddle1Y, 10, 80);

                ctx.fillStyle = '#FF5252';
                ctx.fillRect(canvas.width - 10, gameState.paddle2Y, 10, 80);

                // Draw ball
                ctx.fillStyle = '#FFD700';
                ctx.beginPath();
                ctx.arc(gameState.ballX, gameState.ballY, 5, 0, Math.PI * 2);
                ctx.fill();

                // Update scores
                document.getElementById('score1').textContent = gameState.scores[0];
                document.getElementById('score2').textContent = gameState.scores[1];
            }

            drawLobby() {
                // Simple lobby drawing
                const ctx = this.ctx;
                const canvas = this.canvas;

                ctx.fillStyle = '#0a1429';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                ctx.fillStyle = '#FFD700';
                ctx.font = '30px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('SALA DE AÈ˜TEPTARE', canvas.width / 2, canvas.height / 2 - 50);

                ctx.fillStyle = 'white';
                ctx.font = '20px Arial';
                ctx.fillText('AÈ™teptÃ¢nd jucÄƒtori...', canvas.width / 2, canvas.height / 2 + 20);
            }

            updatePlayerList(players) {
                players.forEach((player, index) => {
                    const playerNum = index + 1;
                    const card = document.getElementById(`player${playerNum}Card`);
                    const status = document.getElementById(`player${playerNum}Status`);
                    const device = document.getElementById(`player${playerNum}Device`);

                    if (player.connected) {
                        card.classList.remove('waiting');
                        status.textContent = player.ready ? 'Gata' : 'ÃŽn aÈ™teptare';
                        device.textContent = player.device === 'mobile' ? 'ðŸ“± Telefon' : 'ðŸ’» Computer';
                        
                        if (player.ready) {
                            card.classList.add('ready');
                        }
                    } else {
                        card.classList.add('waiting');
                        card.classList.remove('ready');
                        status.textContent = 'Deconectat';
                        device.textContent = '-';
                    }
                });
            }

            updateConnectionStatus(status, message) {
                const element = document.getElementById('connectionStatus');
                element.className = `connection-status status-${status}`;
                element.innerHTML = `<p>${message}</p>`;
            }

            showScreen(screenId) {
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });
                document.getElementById(screenId).classList.add('active');
            }

            generateQRCode() {
                const gameUrl = window.location.href;
                const qrContainer = document.getElementById('qrCode');
                
                QRCode.toCanvas(qrContainer, gameUrl, {
                    width: 200,
                    height: 200,
                    margin: 1,
                    color: {
                        dark: '#000000',
                        light: '#FFFFFF'
                    }
                }, function(error) {
                    if (error) {
                        console.error('Error generating QR code:', error);
                        qrContainer.innerHTML = '<p>Error generating QR code</p>';
                    }
                });
            }

            updateGameLink() {
                const gameLink = document.getElementById('gameLink');
                gameLink.value = window.location.href;
            }

            endGame(winner) {
                const winnerName = winner === 'player1' ? 'JucÄƒtorul 1' : 'JucÄƒtorul 2';
                alert(`ðŸŽ‰ ${winnerName} a cÃ¢È™tigat jocul!`);
                this.backToLobby();
            }
        }

        // Global function for copying link
        function copyLink() {
            const gameLink = document.getElementById('gameLink');
            gameLink.select();
            gameLink.setSelectionRange(0, 99999);
            document.execCommand('copy');
            alert('Link copiat Ã®n clipboard!');
        }

        // Initialize the game when page loads
        window.addEventListener('load', () => {
            new PingPongGame();
        });
    </script>
</body>
</html>
